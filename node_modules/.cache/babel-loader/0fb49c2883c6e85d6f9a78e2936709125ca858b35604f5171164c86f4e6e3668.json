{"ast":null,"code":"var _jsxFileName = \"/Users/ikassen/kiakia/frontend/src/components/LeadsTable.jsx\",\n  _s = $RefreshSig$();\nimport React, { useCallback, useMemo, useState } from \"react\";\nimport { format, isValid, parse, parseISO } from \"date-fns\";\nimport { useToast } from \"../contexts/ToastContext\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst QUALITY_LABEL_CLASS = {\n  высокий: \"badge badge-high\",\n  хороший: \"badge badge-good\",\n  средний: \"badge badge-medium\",\n  низкий: \"badge badge-low\"\n};\nfunction formatDate(value) {\n  if (!value) return \"—\";\n  try {\n    const date = new Date(value);\n    if (isNaN(date.getTime())) return value;\n    return format(date, \"dd.MM.yyyy HH:mm\");\n  } catch {\n    return value;\n  }\n}\nfunction toTimestamp(value) {\n  if (!value) return 0;\n  if (typeof value === \"number\") return value;\n  if (value instanceof Date) return value.getTime() || 0;\n  const raw = String(value).trim();\n  if (!raw) return 0;\n  const isoDate = parseISO(raw);\n  if (isValid(isoDate)) return isoDate.getTime();\n  const knownFormats = [\"yyyy-MM-dd HH:mm:ss\", \"yyyy-MM-dd'T'HH:mm:ss\", \"yyyy-MM-dd\", \"dd.MM.yyyy HH:mm\", \"dd.MM.yyyy\"];\n  for (const dateFormat of knownFormats) {\n    const parsed = parse(raw, dateFormat, new Date());\n    if (isValid(parsed)) return parsed.getTime();\n  }\n  const fallback = new Date(raw);\n  return Number.isNaN(fallback.getTime()) ? 0 : fallback.getTime();\n}\nconst LeadsTable = ({\n  leads,\n  limit,\n  offset,\n  onPageChange,\n  onPageSizeChange,\n  onFilterChange,\n  filters,\n  onViewLead,\n  loading\n}) => {\n  _s();\n  const [sortField, setSortField] = useState(\"datetime\");\n  const [isExportModalOpen, setIsExportModalOpen] = useState(false);\n  const [exportFrom, setExportFrom] = useState(\"\");\n  const [exportTo, setExportTo] = useState(\"\");\n  const [exportLoading, setExportLoading] = useState(false);\n  const {\n    addToast\n  } = useToast();\n  const currentPage = Math.floor(offset / limit) + 1;\n  const searchQuery = useMemo(() => (filters.search || \"\").trim().toLowerCase(), [filters.search]);\n  const dateFromTs = useMemo(() => filters.from ? toTimestamp(filters.from) : null, [filters.from]);\n  const dateToTs = useMemo(() => filters.to ? toTimestamp(filters.to) : null, [filters.to]);\n  const {\n    pagedLeads,\n    filteredTotal,\n    sortedLeads\n  } = useMemo(() => {\n    const source = Array.isArray(leads) ? leads : [];\n    const filteredBySearch = searchQuery ? source.filter(lead => {\n      const name = (lead.name || \"\").toLowerCase();\n      const phone = (lead.phone || lead.phone_number || lead.client_phone || lead.contact_phone || lead.mobile || \"\").toString().toLowerCase();\n      return name.includes(searchQuery) || phone.includes(searchQuery);\n    }) : source;\n    const filteredByQuality = filters.quality && filters.quality !== \"all\" ? filteredBySearch.filter(lead => lead.client_quality_bucket === filters.quality) : filteredBySearch;\n    const filteredByDate = filteredByQuality.filter(lead => {\n      const leadTs = toTimestamp(lead.datetime);\n      if (dateFromTs && leadTs < dateFromTs) return false;\n      if (dateToTs && leadTs > dateToTs) return false;\n      return true;\n    });\n    const sorted = [...filteredByDate].sort((a, b) => {\n      const dir = sortDirection === \"asc\" ? 1 : -1;\n      let av = a[sortField];\n      let bv = b[sortField];\n      if (sortField === \"datetime\") {\n        av = toTimestamp(av);\n        bv = toTimestamp(bv);\n      }\n      if (av === bv) return 0;\n      if (typeof av === \"string\" && typeof bv === \"string\") {\n        return av.localeCompare(bv) * dir;\n      }\n      return av > bv ? dir : -dir;\n    });\n    const totalCount = sorted.length;\n    const start = offset;\n    const page = sorted.slice(start, start + limit);\n    return {\n      pagedLeads: page,\n      filteredTotal: totalCount,\n      sortedLeads: sorted\n    };\n  }, [leads, searchQuery, filters.quality, dateFromTs, dateToTs, sortField, sortDirection, offset, limit]);\n  const totalPages = Math.max(1, Math.ceil(filteredTotal / limit));\n  const handleQualityChange = useCallback(e => {\n    onFilterChange({\n      ...filters,\n      quality: e.target.value\n    });\n  }, [filters, onFilterChange]);\n  const handleSearchChange = useCallback(e => {\n    onFilterChange({\n      ...filters,\n      search: e.target.value\n    });\n  }, [filters, onFilterChange]);\n  const handleFromChange = useCallback(e => {\n    const value = e.target.value ? `${e.target.value}T00:00:00` : \"\";\n    onFilterChange({\n      ...filters,\n      from: value\n    });\n  }, [filters, onFilterChange]);\n  const handleToChange = useCallback(e => {\n    const value = e.target.value ? `${e.target.value}T23:59:59` : \"\";\n    onFilterChange({\n      ...filters,\n      to: value\n    });\n  }, [filters, onFilterChange]);\n  const handleLimitChange = useCallback(e => {\n    const newLimit = Number(e.target.value) || 10;\n    onPageSizeChange(newLimit);\n  }, [onPageSizeChange]);\n  const goToPage = useCallback(page => {\n    if (page < 1 || page > totalPages) return;\n    const newOffset = (page - 1) * limit;\n    onPageChange(newOffset);\n  }, [limit, onPageChange, totalPages]);\n  const changeSort = useCallback(field => {\n    setSortField(prevField => {\n      if (prevField === field) {\n        setSortDirection(prevDir => prevDir === \"asc\" ? \"desc\" : \"asc\");\n        return prevField;\n      }\n      setSortDirection(field === \"datetime\" ? \"desc\" : \"asc\");\n      return field;\n    });\n  }, []);\n  const buildCsvRows = sourceLeads => (sourceLeads || []).map(lead => ({\n    id: lead.id,\n    datetime: lead.datetime,\n    name: lead.name,\n    city: lead.city,\n    selected_car: lead.selected_car,\n    purchase_method: lead.purchase_method,\n    client_quality: lead.client_quality,\n    traffic_source: lead.traffic_source,\n    messenger: lead.messenger,\n    dealer_center: lead.dealer_center,\n    dialog_link: lead.dialog_link,\n    summary_dialog: lead.summary_dialog,\n    source_system: lead.source_system,\n    platform_user_id: lead.platform_user_id\n  }));\n  const triggerCsvDownload = useCallback((rows, fileName) => {\n    const header = Object.keys(rows[0]);\n    const csvLines = [header.join(\",\"), ...rows.map(row => header.map(key => {\n      var _row$key;\n      const value = (_row$key = row[key]) !== null && _row$key !== void 0 ? _row$key : \"\";\n      const escaped = String(value).replace(/\"/g, '\"\"');\n      return `\"${escaped}\"`;\n    }).join(\",\"))];\n    const blob = new Blob([csvLines.join(\"\\n\")], {\n      type: \"text/csv;charset=utf-8;\"\n    });\n    const url = URL.createObjectURL(blob);\n    const link = document.createElement(\"a\");\n    link.href = url;\n    link.download = fileName;\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n    URL.revokeObjectURL(url);\n  }, []);\n  const openExportModal = useCallback(() => {\n    setExportFrom(filters.from ? filters.from.slice(0, 10) : \"\");\n    setExportTo(filters.to ? filters.to.slice(0, 10) : \"\");\n    setIsExportModalOpen(true);\n  }, [filters.from, filters.to]);\n  const closeExportModal = useCallback(() => {\n    if (exportLoading) return;\n    setIsExportModalOpen(false);\n  }, [exportLoading]);\n  const exportToCsv = useCallback(async () => {\n    if (!exportFrom || !exportTo) {\n      window.alert(\"Выберите начальную и конечную даты для экспорта.\");\n      return;\n    }\n    const from = `${exportFrom}T00:00:00`;\n    const to = `${exportTo}T23:59:59`;\n    const fromTs = toTimestamp(from);\n    const toTs = toTimestamp(to);\n    if (!fromTs || !toTs || fromTs > toTs) {\n      window.alert(\"Проверьте корректность диапазона дат.\");\n      return;\n    }\n    setExportLoading(true);\n    try {\n      const exportFiltered = sortedLeads.filter(lead => {\n        const leadTs = toTimestamp(lead.datetime);\n        return leadTs >= fromTs && leadTs <= toTs;\n      });\n      const rows = buildCsvRows(exportFiltered);\n      if (rows.length === 0) {\n        window.alert(\"Нет данных за выбранный диапазон дат.\");\n        return;\n      }\n      triggerCsvDownload(rows, `leads-${exportFrom}-${exportTo}.csv`);\n      addToast(\"CSV успешно скачан.\", \"success\");\n      setIsExportModalOpen(false);\n    } catch (error) {\n      // eslint-disable-next-line no-console\n      console.error(\"Ошибка экспорта CSV\", error);\n      addToast(\"Не удалось выгрузить CSV.\", \"error\");\n    } finally {\n      setExportLoading(false);\n    }\n  }, [exportFrom, exportTo, sortedLeads, triggerCsvDownload, addToast]);\n  const dateSortArrow = sortField === \"datetime\" ? sortDirection === \"desc\" ? \" ↓\" : \" ↑\" : \"\";\n  const rowsLabel = useMemo(() => pagedLeads.length, [pagedLeads]);\n  const showEmptyState = !loading && pagedLeads.length === 0;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"card p-4\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex flex-col gap-3 sm:flex-row sm:items-end sm:justify-between mb-4\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"space-y-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"text-sm font-semibold text-slate-700 dark:text-slate-200\",\n          children: \"\\u041B\\u0438\\u0434\\u044B\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 290,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-xs text-slate-500 dark:text-slate-400\",\n          children: \"\\u041F\\u043E\\u0438\\u0441\\u043A \\u043F\\u043E \\u0438\\u043C\\u0435\\u043D\\u0438 / \\u0442\\u0435\\u043B\\u0435\\u0444\\u043E\\u043D\\u0443, \\u0444\\u0438\\u043B\\u044C\\u0442\\u0440 \\u043F\\u043E \\u043A\\u0430\\u0447\\u0435\\u0441\\u0442\\u0432\\u0443 \\u0438 \\u0434\\u0430\\u0442\\u0430\\u043C.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 293,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 289,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex flex-wrap gap-2 items-end\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex flex-col\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"text-xs text-slate-500 dark:text-slate-400 mb-1\",\n            children: \"\\u041F\\u043E\\u0438\\u0441\\u043A\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 299,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            value: filters.search || \"\",\n            onChange: handleSearchChange,\n            placeholder: \"\\u0418\\u043C\\u044F \\u0438\\u043B\\u0438 \\u0442\\u0435\\u043B\\u0435\\u0444\\u043E\\u043D...\",\n            className: \"w-40 rounded-md border border-slate-200 px-2 py-1 text-sm shadow-sm focus:border-primary-500 focus:outline-none focus:ring-1 focus:ring-primary-500 dark:bg-slate-900 dark:border-slate-700 dark:text-slate-100\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 300,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 298,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex flex-col\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"text-xs text-slate-500 dark:text-slate-400 mb-1\",\n            children: \"\\u041A\\u0430\\u0447\\u0435\\u0441\\u0442\\u0432\\u043E\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 309,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            value: filters.quality || \"all\",\n            onChange: handleQualityChange,\n            className: \"w-32 rounded-md border border-slate-200 px-2 py-1 text-sm shadow-sm focus:border-primary-500 focus:outline-none focus:ring-1 focus:ring-primary-500 dark:bg-slate-900 dark:border-slate-700 dark:text-slate-100\",\n            children: [/*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"all\",\n              children: \"\\u0412\\u0441\\u0435\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 315,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"\\u0432\\u044B\\u0441\\u043E\\u043A\\u0438\\u0439\",\n              children: \"\\u0412\\u044B\\u0441\\u043E\\u043A\\u0438\\u0439\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 316,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"\\u0445\\u043E\\u0440\\u043E\\u0448\\u0438\\u0439\",\n              children: \"\\u0425\\u043E\\u0440\\u043E\\u0448\\u0438\\u0439\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 317,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"\\u0441\\u0440\\u0435\\u0434\\u043D\\u0438\\u0439\",\n              children: \"\\u0421\\u0440\\u0435\\u0434\\u043D\\u0438\\u0439\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 318,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"\\u043D\\u0438\\u0437\\u043A\\u0438\\u0439\",\n              children: \"\\u041D\\u0438\\u0437\\u043A\\u0438\\u0439\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 319,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 310,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 308,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex flex-col\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"text-xs text-slate-500 dark:text-slate-400 mb-1\",\n            children: \"\\u0421 \\u0434\\u0430\\u0442\\u044B\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 323,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"date\",\n            value: filters.from ? filters.from.slice(0, 10) : \"\",\n            onChange: handleFromChange,\n            className: \"w-36 rounded-md border border-slate-200 px-2 py-1 text-sm shadow-sm focus:border-primary-500 focus:outline-none focus:ring-1 focus:ring-primary-500 dark:bg-slate-900 dark:border-slate-700 dark:text-slate-100\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 324,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 322,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex flex-col\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"text-xs text-slate-500 dark:text-slate-400 mb-1\",\n            children: \"\\u041F\\u043E \\u0434\\u0430\\u0442\\u0443\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 332,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"date\",\n            value: filters.to ? filters.to.slice(0, 10) : \"\",\n            onChange: handleToChange,\n            className: \"w-36 rounded-md border border-slate-200 px-2 py-1 text-sm shadow-sm focus:border-primary-500 focus:outline-none focus:ring-1 focus:ring-primary-500 dark:bg-slate-900 dark:border-slate-700 dark:text-slate-100\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 333,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 331,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex flex-col\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"text-xs text-slate-500 dark:text-slate-400 mb-1\",\n            children: \"\\u041D\\u0430 \\u0441\\u0442\\u0440\\u0430\\u043D\\u0438\\u0446\\u0435\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 341,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            value: limit,\n            onChange: handleLimitChange,\n            className: \"w-24 rounded-md border border-slate-200 px-2 py-1 text-sm shadow-sm focus:border-primary-500 focus:outline-none focus:ring-1 focus:ring-primary-500 dark:bg-slate-900 dark:border-slate-700 dark:text-slate-100\",\n            children: [/*#__PURE__*/_jsxDEV(\"option\", {\n              value: 10,\n              children: \"10\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 347,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: 25,\n              children: \"25\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 348,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: 50,\n              children: \"50\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 349,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 342,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 340,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 297,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 288,\n      columnNumber: 7\n    }, this), showEmptyState ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex flex-col items-center justify-center rounded-xl border border-dashed border-slate-200 bg-slate-50 px-6 py-10 text-center dark:border-slate-700 dark:bg-slate-900/40\",\n      children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n        className: \"h-12 w-12 text-slate-400\",\n        viewBox: \"0 0 48 48\",\n        fill: \"none\",\n        xmlns: \"http://www.w3.org/2000/svg\",\n        children: [/*#__PURE__*/_jsxDEV(\"path\", {\n          d: \"M10 12h28M10 20h28M10 28h16\",\n          stroke: \"currentColor\",\n          strokeWidth: \"3\",\n          strokeLinecap: \"round\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 363,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"circle\", {\n          cx: \"36\",\n          cy: \"32\",\n          r: \"6\",\n          stroke: \"currentColor\",\n          strokeWidth: \"3\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 369,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 357,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n        className: \"mt-4 text-sm font-semibold text-slate-700 dark:text-slate-200\",\n        children: \"\\u041D\\u0438\\u0447\\u0435\\u0433\\u043E \\u043D\\u0435 \\u043D\\u0430\\u0439\\u0434\\u0435\\u043D\\u043E\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 371,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"mt-1 text-xs text-slate-500 dark:text-slate-400\",\n        children: \"\\u041F\\u043E\\u043F\\u0440\\u043E\\u0431\\u0443\\u0439\\u0442\\u0435 \\u0438\\u0437\\u043C\\u0435\\u043D\\u0438\\u0442\\u044C \\u0437\\u0430\\u043F\\u0440\\u043E\\u0441 \\u0438\\u043B\\u0438 \\u0441\\u043D\\u044F\\u0442\\u044C \\u0444\\u0438\\u043B\\u044C\\u0442\\u0440\\u044B.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 374,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 356,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"overflow-x-auto\",\n      children: /*#__PURE__*/_jsxDEV(\"table\", {\n        className: \"min-w-full text-sm\",\n        children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n          className: \"table-header sticky top-0 z-10\",\n          children: /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: [/*#__PURE__*/_jsxDEV(\"th\", {\n              className: \"px-3 py-2 text-left cursor-pointer\",\n              onClick: () => changeSort(\"name\"),\n              title: \"\\u0421\\u043E\\u0440\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C \\u043F\\u043E \\u0438\\u043C\\u0435\\u043D\\u0438\",\n              children: \"\\u0418\\u043C\\u044F\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 383,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              className: \"px-3 py-2 text-left cursor-pointer\",\n              onClick: () => changeSort(\"selected_car\"),\n              title: \"\\u0421\\u043E\\u0440\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C \\u043F\\u043E \\u043C\\u043E\\u0434\\u0435\\u043B\\u0438\",\n              children: \"\\u041C\\u043E\\u0434\\u0435\\u043B\\u044C\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 390,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              className: \"px-3 py-2 text-left cursor-pointer\",\n              onClick: () => changeSort(\"client_quality\"),\n              title: \"\\u0421\\u043E\\u0440\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C \\u043F\\u043E \\u043A\\u0430\\u0447\\u0435\\u0441\\u0442\\u0432\\u0443\",\n              children: \"\\u041A\\u0430\\u0447\\u0435\\u0441\\u0442\\u0432\\u043E\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 397,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              className: \"px-3 py-2 text-left cursor-pointer\",\n              onClick: () => changeSort(\"datetime\"),\n              title: \"\\u0421\\u043E\\u0440\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C \\u043F\\u043E \\u0434\\u0430\\u0442\\u0435\",\n              children: [\"\\u0414\\u0430\\u0442\\u0430\", dateSortArrow]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 404,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              className: \"px-3 py-2 text-left\",\n              children: \"\\u0413\\u043E\\u0440\\u043E\\u0434\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 411,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              className: \"px-3 py-2 text-left\",\n              children: \"\\u0418\\u0441\\u0442\\u043E\\u0447\\u043D\\u0438\\u043A\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 412,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              className: \"px-3 py-2 text-left\",\n              children: \"\\u041A\\u0430\\u043D\\u0430\\u043B\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 413,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              className: \"px-3 py-2 text-right\",\n              children: \"\\u0414\\u0435\\u0439\\u0441\\u0442\\u0432\\u0438\\u044F\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 414,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 382,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 381,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n          children: loading ? Array.from({\n            length: 6\n          }).map((_, idx) => /*#__PURE__*/_jsxDEV(\"tr\", {\n            className: \"table-row\",\n            children: /*#__PURE__*/_jsxDEV(\"td\", {\n              colSpan: 8,\n              className: \"px-3 py-3\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"h-3 w-full animate-pulse rounded bg-slate-200 dark:bg-slate-700\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 422,\n                columnNumber: 23\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 421,\n              columnNumber: 21\n            }, this)\n          }, `skeleton-${idx}`, false, {\n            fileName: _jsxFileName,\n            lineNumber: 420,\n            columnNumber: 19\n          }, this)) : pagedLeads.map(lead => {\n            const qualityClass = QUALITY_LABEL_CLASS[lead.client_quality_bucket] || \"badge bg-slate-100 text-slate-700\";\n            const qualityStripeClass = lead.client_quality_bucket === \"высокий\" ? \"border-l-4 border-emerald-500\" : lead.client_quality_bucket === \"хороший\" ? \"border-l-4 border-sky-500\" : lead.client_quality_bucket === \"средний\" ? \"border-l-4 border-amber-500\" : \"border-l-4 border-rose-500\";\n            return /*#__PURE__*/_jsxDEV(\"tr\", {\n              className: `table-row ${qualityStripeClass}`,\n              children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"px-3 py-2 whitespace-nowrap text-sm text-slate-800 dark:text-slate-100\",\n                children: lead.name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 441,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"px-3 py-2 whitespace-nowrap text-sm text-slate-700 dark:text-slate-300\",\n                children: lead.selected_car\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 444,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"px-3 py-2 whitespace-nowrap\",\n                children: /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: qualityClass,\n                  children: [lead.client_quality_bucket, \" (\", lead.client_quality, \")\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 448,\n                  columnNumber: 25\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 447,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"px-3 py-2 whitespace-nowrap text-sm text-slate-700 dark:text-slate-300\",\n                children: formatDate(lead.datetime)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 452,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"px-3 py-2 whitespace-nowrap text-sm text-slate-700 dark:text-slate-300\",\n                children: lead.city\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 455,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"px-3 py-2 whitespace-nowrap text-sm text-slate-700 dark:text-slate-300\",\n                children: lead.traffic_source\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 458,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"px-3 py-2 whitespace-nowrap text-sm text-slate-700 dark:text-slate-300\",\n                children: lead.messenger\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 461,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"px-3 py-2 text-right\",\n                children: /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: () => onViewLead(lead),\n                  className: \"inline-flex items-center rounded-md border border-slate-200 px-3 py-1 text-xs font-medium text-slate-700 hover:bg-slate-50 dark:border-slate-700 dark:text-slate-100 dark:hover:bg-slate-800\",\n                  children: \"\\u041F\\u0440\\u043E\\u0441\\u043C\\u043E\\u0442\\u0440\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 465,\n                  columnNumber: 25\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 464,\n                columnNumber: 23\n              }, this)]\n            }, lead.id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 440,\n              columnNumber: 21\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 417,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 380,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 379,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mt-4 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between\",\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-xs text-slate-500 dark:text-slate-400\",\n        children: [\"\\u041F\\u043E\\u043A\\u0430\\u0437\\u0430\\u043D\\u043E \", rowsLabel, \" \\u0438\\u0437 \", filteredTotal, \" \\u043B\\u0438\\u0434\\u043E\\u0432.\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 482,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center gap-2 justify-end\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => goToPage(currentPage - 1),\n          disabled: currentPage <= 1,\n          className: \"rounded-md border border-slate-200 px-2 py-1 text-xs text-slate-600 disabled:opacity-40 disabled:cursor-not-allowed hover:bg-slate-50 dark:border-slate-700 dark:text-slate-300 dark:hover:bg-slate-800\",\n          children: \"\\u041D\\u0430\\u0437\\u0430\\u0434\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 486,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-xs text-slate-600 dark:text-slate-300\",\n          children: [\"\\u0421\\u0442\\u0440. \", currentPage, \" / \", totalPages]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 493,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => goToPage(currentPage + 1),\n          disabled: currentPage >= totalPages,\n          className: \"rounded-md border border-slate-200 px-2 py-1 text-xs text-slate-600 disabled:opacity-40 disabled:cursor-not-allowed hover:bg-slate-50 dark:border-slate-700 dark:text-slate-300 dark:hover:bg-slate-800\",\n          children: \"\\u0414\\u0430\\u043B\\u0435\\u0435\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 496,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          onClick: openExportModal,\n          className: \"ml-2 rounded-md border border-slate-200 px-3 py-1 text-xs font-medium text-slate-700 hover:bg-slate-50 dark:border-slate-700 dark:text-slate-100 dark:hover:bg-slate-800\",\n          children: \"\\u042D\\u043A\\u0441\\u043F\\u043E\\u0440\\u0442 CSV\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 503,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 485,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 481,\n      columnNumber: 7\n    }, this), isExportModalOpen && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/50 p-4\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-full max-w-md rounded-xl border border-slate-200 bg-white p-4 shadow-lg dark:border-slate-700 dark:bg-slate-800\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-sm font-semibold text-slate-800 dark:text-slate-100\",\n          children: \"\\u042D\\u043A\\u0441\\u043F\\u043E\\u0440\\u0442 CSV \\u043F\\u043E \\u0434\\u0438\\u0430\\u043F\\u0430\\u0437\\u043E\\u043D\\u0443 \\u0434\\u0430\\u0442\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 516,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"mt-1 text-xs text-slate-500 dark:text-slate-400\",\n          children: \"\\u0412\\u044B\\u0431\\u0435\\u0440\\u0438\\u0442\\u0435 \\u043D\\u0430\\u0447\\u0430\\u043B\\u044C\\u043D\\u0443\\u044E \\u0438 \\u043A\\u043E\\u043D\\u0435\\u0447\\u043D\\u0443\\u044E \\u0434\\u0430\\u0442\\u044B. \\u0412 \\u044D\\u043A\\u0441\\u043F\\u043E\\u0440\\u0442 \\u043F\\u043E\\u043F\\u0430\\u0434\\u0443\\u0442 \\u0442\\u043E\\u043B\\u044C\\u043A\\u043E \\u043B\\u0438\\u0434\\u044B \\u0432 \\u044D\\u0442\\u043E\\u043C \\u0434\\u0438\\u0430\\u043F\\u0430\\u0437\\u043E\\u043D\\u0435.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 519,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mt-3 grid gap-3 sm:grid-cols-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"text-xs text-slate-600 dark:text-slate-300\",\n            children: [\"Start Date\", /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"date\",\n              value: exportFrom,\n              onChange: e => setExportFrom(e.target.value),\n              className: \"mt-1 w-full rounded-md border border-slate-200 px-2 py-1 text-sm focus:border-primary-500 focus:outline-none focus:ring-1 focus:ring-primary-500 dark:bg-slate-900 dark:border-slate-700 dark:text-slate-100\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 526,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 524,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"text-xs text-slate-600 dark:text-slate-300\",\n            children: [\"End Date\", /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"date\",\n              value: exportTo,\n              onChange: e => setExportTo(e.target.value),\n              className: \"mt-1 w-full rounded-md border border-slate-200 px-2 py-1 text-sm focus:border-primary-500 focus:outline-none focus:ring-1 focus:ring-primary-500 dark:bg-slate-900 dark:border-slate-700 dark:text-slate-100\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 535,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 533,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 523,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mt-4 flex justify-end gap-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            onClick: closeExportModal,\n            disabled: exportLoading,\n            className: \"rounded-md border border-slate-200 px-3 py-1 text-xs text-slate-700 hover:bg-slate-50 disabled:opacity-60 dark:border-slate-700 dark:text-slate-200 dark:hover:bg-slate-700\",\n            children: \"\\u041E\\u0442\\u043C\\u0435\\u043D\\u0430\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 545,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            onClick: exportToCsv,\n            disabled: exportLoading,\n            className: \"rounded-md bg-primary-600 px-3 py-1 text-xs font-medium text-white hover:bg-primary-700 disabled:opacity-60\",\n            children: exportLoading ? \"Экспорт...\" : \"Скачать CSV\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 553,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 544,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 515,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 514,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 287,\n    columnNumber: 5\n  }, this);\n};\n_s(LeadsTable, \"iDw6EsQgvJz35uBghRVPoLW8bhs=\", false, function () {\n  return [useToast];\n});\n_c = LeadsTable;\nexport default LeadsTable;\nvar _c;\n$RefreshReg$(_c, \"LeadsTable\");","map":{"version":3,"names":["React","useCallback","useMemo","useState","format","isValid","parse","parseISO","useToast","jsxDEV","_jsxDEV","QUALITY_LABEL_CLASS","высокий","хороший","средний","низкий","formatDate","value","date","Date","isNaN","getTime","toTimestamp","raw","String","trim","isoDate","knownFormats","dateFormat","parsed","fallback","Number","LeadsTable","leads","limit","offset","onPageChange","onPageSizeChange","onFilterChange","filters","onViewLead","loading","_s","sortField","setSortField","isExportModalOpen","setIsExportModalOpen","exportFrom","setExportFrom","exportTo","setExportTo","exportLoading","setExportLoading","addToast","currentPage","Math","floor","searchQuery","search","toLowerCase","dateFromTs","from","dateToTs","to","pagedLeads","filteredTotal","sortedLeads","source","Array","isArray","filteredBySearch","filter","lead","name","phone","phone_number","client_phone","contact_phone","mobile","toString","includes","filteredByQuality","quality","client_quality_bucket","filteredByDate","leadTs","datetime","sorted","sort","a","b","dir","sortDirection","av","bv","localeCompare","totalCount","length","start","page","slice","totalPages","max","ceil","handleQualityChange","e","target","handleSearchChange","handleFromChange","handleToChange","handleLimitChange","newLimit","goToPage","newOffset","changeSort","field","prevField","setSortDirection","prevDir","buildCsvRows","sourceLeads","map","id","city","selected_car","purchase_method","client_quality","traffic_source","messenger","dealer_center","dialog_link","summary_dialog","source_system","platform_user_id","triggerCsvDownload","rows","fileName","header","Object","keys","csvLines","join","row","key","_row$key","escaped","replace","blob","Blob","type","url","URL","createObjectURL","link","document","createElement","href","download","body","appendChild","click","removeChild","revokeObjectURL","openExportModal","closeExportModal","exportToCsv","window","alert","fromTs","toTs","exportFiltered","error","console","dateSortArrow","rowsLabel","showEmptyState","className","children","_jsxFileName","lineNumber","columnNumber","onChange","placeholder","viewBox","fill","xmlns","d","stroke","strokeWidth","strokeLinecap","cx","cy","r","onClick","title","_","idx","colSpan","qualityClass","qualityStripeClass","disabled","_c","$RefreshReg$"],"sources":["/Users/ikassen/kiakia/frontend/src/components/LeadsTable.jsx"],"sourcesContent":["import React, { useCallback, useMemo, useState } from \"react\";\nimport { format, isValid, parse, parseISO } from \"date-fns\";\nimport { useToast } from \"../contexts/ToastContext\";\n\nconst QUALITY_LABEL_CLASS = {\n  высокий: \"badge badge-high\",\n  хороший: \"badge badge-good\",\n  средний: \"badge badge-medium\",\n  низкий: \"badge badge-low\"\n};\n\nfunction formatDate(value) {\n  if (!value) return \"—\";\n  try {\n    const date = new Date(value);\n    if (isNaN(date.getTime())) return value;\n    return format(date, \"dd.MM.yyyy HH:mm\");\n  } catch {\n    return value;\n  }\n}\n\nfunction toTimestamp(value) {\n  if (!value) return 0;\n  if (typeof value === \"number\") return value;\n  if (value instanceof Date) return value.getTime() || 0;\n\n  const raw = String(value).trim();\n  if (!raw) return 0;\n\n  const isoDate = parseISO(raw);\n  if (isValid(isoDate)) return isoDate.getTime();\n\n  const knownFormats = [\n    \"yyyy-MM-dd HH:mm:ss\",\n    \"yyyy-MM-dd'T'HH:mm:ss\",\n    \"yyyy-MM-dd\",\n    \"dd.MM.yyyy HH:mm\",\n    \"dd.MM.yyyy\"\n  ];\n\n  for (const dateFormat of knownFormats) {\n    const parsed = parse(raw, dateFormat, new Date());\n    if (isValid(parsed)) return parsed.getTime();\n  }\n\n  const fallback = new Date(raw);\n  return Number.isNaN(fallback.getTime()) ? 0 : fallback.getTime();\n}\n\nconst LeadsTable = ({\n  leads,\n  limit,\n  offset,\n  onPageChange,\n  onPageSizeChange,\n  onFilterChange,\n  filters,\n  onViewLead,\n  loading\n}) => {\n  const [sortField, setSortField] = useState(\"datetime\");\n  const [isExportModalOpen, setIsExportModalOpen] = useState(false);\n  const [exportFrom, setExportFrom] = useState(\"\");\n  const [exportTo, setExportTo] = useState(\"\");\n  const [exportLoading, setExportLoading] = useState(false);\n  const { addToast } = useToast();\n  const currentPage = Math.floor(offset / limit) + 1;\n\n  const searchQuery = useMemo(\n    () => (filters.search || \"\").trim().toLowerCase(),\n    [filters.search]\n  );\n\n  const dateFromTs = useMemo(\n    () => (filters.from ? toTimestamp(filters.from) : null),\n    [filters.from]\n  );\n\n  const dateToTs = useMemo(\n    () => (filters.to ? toTimestamp(filters.to) : null),\n    [filters.to]\n  );\n\n  const { pagedLeads, filteredTotal, sortedLeads } = useMemo(() => {\n    const source = Array.isArray(leads) ? leads : [];\n\n    const filteredBySearch = searchQuery\n      ? source.filter((lead) => {\n          const name = (lead.name || \"\").toLowerCase();\n          const phone = (\n            lead.phone ||\n            lead.phone_number ||\n            lead.client_phone ||\n            lead.contact_phone ||\n            lead.mobile ||\n            \"\"\n          ).toString().toLowerCase();\n          return name.includes(searchQuery) || phone.includes(searchQuery);\n        })\n      : source;\n\n    const filteredByQuality =\n      filters.quality && filters.quality !== \"all\"\n        ? filteredBySearch.filter(\n            (lead) => lead.client_quality_bucket === filters.quality\n          )\n        : filteredBySearch;\n\n    const filteredByDate = filteredByQuality.filter((lead) => {\n      const leadTs = toTimestamp(lead.datetime);\n      if (dateFromTs && leadTs < dateFromTs) return false;\n      if (dateToTs && leadTs > dateToTs) return false;\n      return true;\n    });\n\n    const sorted = [...filteredByDate].sort((a, b) => {\n      const dir = sortDirection === \"asc\" ? 1 : -1;\n      let av = a[sortField];\n      let bv = b[sortField];\n      if (sortField === \"datetime\") {\n        av = toTimestamp(av);\n        bv = toTimestamp(bv);\n      }\n      if (av === bv) return 0;\n      if (typeof av === \"string\" && typeof bv === \"string\") {\n        return av.localeCompare(bv) * dir;\n      }\n      return av > bv ? dir : -dir;\n    });\n\n    const totalCount = sorted.length;\n    const start = offset;\n    const page = sorted.slice(start, start + limit);\n\n    return { pagedLeads: page, filteredTotal: totalCount, sortedLeads: sorted };\n  }, [leads, searchQuery, filters.quality, dateFromTs, dateToTs, sortField, sortDirection, offset, limit]);\n\n  const totalPages = Math.max(1, Math.ceil(filteredTotal / limit));\n\n  const handleQualityChange = useCallback((e) => {\n    onFilterChange({ ...filters, quality: e.target.value });\n  }, [filters, onFilterChange]);\n\n  const handleSearchChange = useCallback((e) => {\n    onFilterChange({ ...filters, search: e.target.value });\n  }, [filters, onFilterChange]);\n\n  const handleFromChange = useCallback((e) => {\n    const value = e.target.value ? `${e.target.value}T00:00:00` : \"\";\n    onFilterChange({ ...filters, from: value });\n  }, [filters, onFilterChange]);\n\n  const handleToChange = useCallback((e) => {\n    const value = e.target.value ? `${e.target.value}T23:59:59` : \"\";\n    onFilterChange({ ...filters, to: value });\n  }, [filters, onFilterChange]);\n\n  const handleLimitChange = useCallback((e) => {\n    const newLimit = Number(e.target.value) || 10;\n    onPageSizeChange(newLimit);\n  }, [onPageSizeChange]);\n\n  const goToPage = useCallback((page) => {\n    if (page < 1 || page > totalPages) return;\n    const newOffset = (page - 1) * limit;\n    onPageChange(newOffset);\n  }, [limit, onPageChange, totalPages]);\n\n  const changeSort = useCallback((field) => {\n    setSortField((prevField) => {\n      if (prevField === field) {\n        setSortDirection((prevDir) => (prevDir === \"asc\" ? \"desc\" : \"asc\"));\n        return prevField;\n      }\n      setSortDirection(field === \"datetime\" ? \"desc\" : \"asc\");\n      return field;\n    });\n  }, []);\n\n  const buildCsvRows = (sourceLeads) =>\n    (sourceLeads || []).map((lead) => ({\n      id: lead.id,\n      datetime: lead.datetime,\n      name: lead.name,\n      city: lead.city,\n      selected_car: lead.selected_car,\n      purchase_method: lead.purchase_method,\n      client_quality: lead.client_quality,\n      traffic_source: lead.traffic_source,\n      messenger: lead.messenger,\n      dealer_center: lead.dealer_center,\n      dialog_link: lead.dialog_link,\n      summary_dialog: lead.summary_dialog,\n      source_system: lead.source_system,\n      platform_user_id: lead.platform_user_id\n    }));\n\n  const triggerCsvDownload = useCallback((rows, fileName) => {\n    const header = Object.keys(rows[0]);\n    const csvLines = [\n      header.join(\",\"),\n      ...rows.map((row) =>\n        header\n          .map((key) => {\n            const value = row[key] ?? \"\";\n            const escaped = String(value).replace(/\"/g, '\"\"');\n            return `\"${escaped}\"`;\n          })\n          .join(\",\")\n      )\n    ];\n\n    const blob = new Blob([csvLines.join(\"\\n\")], {\n      type: \"text/csv;charset=utf-8;\"\n    });\n    const url = URL.createObjectURL(blob);\n    const link = document.createElement(\"a\");\n    link.href = url;\n    link.download = fileName;\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n    URL.revokeObjectURL(url);\n  }, []);\n\n  const openExportModal = useCallback(() => {\n    setExportFrom(filters.from ? filters.from.slice(0, 10) : \"\");\n    setExportTo(filters.to ? filters.to.slice(0, 10) : \"\");\n    setIsExportModalOpen(true);\n  }, [filters.from, filters.to]);\n\n  const closeExportModal = useCallback(() => {\n    if (exportLoading) return;\n    setIsExportModalOpen(false);\n  }, [exportLoading]);\n\n  const exportToCsv = useCallback(async () => {\n    if (!exportFrom || !exportTo) {\n      window.alert(\"Выберите начальную и конечную даты для экспорта.\");\n      return;\n    }\n\n    const from = `${exportFrom}T00:00:00`;\n    const to = `${exportTo}T23:59:59`;\n    const fromTs = toTimestamp(from);\n    const toTs = toTimestamp(to);\n\n    if (!fromTs || !toTs || fromTs > toTs) {\n      window.alert(\"Проверьте корректность диапазона дат.\");\n      return;\n    }\n\n    setExportLoading(true);\n    try {\n      const exportFiltered = sortedLeads.filter((lead) => {\n        const leadTs = toTimestamp(lead.datetime);\n        return leadTs >= fromTs && leadTs <= toTs;\n      });\n\n      const rows = buildCsvRows(exportFiltered);\n      if (rows.length === 0) {\n        window.alert(\"Нет данных за выбранный диапазон дат.\");\n        return;\n      }\n\n      triggerCsvDownload(rows, `leads-${exportFrom}-${exportTo}.csv`);\n      addToast(\"CSV успешно скачан.\", \"success\");\n      setIsExportModalOpen(false);\n    } catch (error) {\n      // eslint-disable-next-line no-console\n      console.error(\"Ошибка экспорта CSV\", error);\n      addToast(\"Не удалось выгрузить CSV.\", \"error\");\n    } finally {\n      setExportLoading(false);\n    }\n  }, [exportFrom, exportTo, sortedLeads, triggerCsvDownload, addToast]);\n\n  const dateSortArrow =\n    sortField === \"datetime\" ? (sortDirection === \"desc\" ? \" ↓\" : \" ↑\") : \"\";\n\n  const rowsLabel = useMemo(() => pagedLeads.length, [pagedLeads]);\n\n  const showEmptyState = !loading && pagedLeads.length === 0;\n\n  return (\n    <div className=\"card p-4\">\n      <div className=\"flex flex-col gap-3 sm:flex-row sm:items-end sm:justify-between mb-4\">\n        <div className=\"space-y-2\">\n          <h2 className=\"text-sm font-semibold text-slate-700 dark:text-slate-200\">\n            Лиды\n          </h2>\n          <p className=\"text-xs text-slate-500 dark:text-slate-400\">\n            Поиск по имени / телефону, фильтр по качеству и датам.\n          </p>\n        </div>\n        <div className=\"flex flex-wrap gap-2 items-end\">\n          <div className=\"flex flex-col\">\n            <label className=\"text-xs text-slate-500 dark:text-slate-400 mb-1\">Поиск</label>\n            <input\n              type=\"text\"\n              value={filters.search || \"\"}\n              onChange={handleSearchChange}\n              placeholder=\"Имя или телефон...\"\n              className=\"w-40 rounded-md border border-slate-200 px-2 py-1 text-sm shadow-sm focus:border-primary-500 focus:outline-none focus:ring-1 focus:ring-primary-500 dark:bg-slate-900 dark:border-slate-700 dark:text-slate-100\"\n            />\n          </div>\n          <div className=\"flex flex-col\">\n            <label className=\"text-xs text-slate-500 dark:text-slate-400 mb-1\">Качество</label>\n            <select\n              value={filters.quality || \"all\"}\n              onChange={handleQualityChange}\n              className=\"w-32 rounded-md border border-slate-200 px-2 py-1 text-sm shadow-sm focus:border-primary-500 focus:outline-none focus:ring-1 focus:ring-primary-500 dark:bg-slate-900 dark:border-slate-700 dark:text-slate-100\"\n            >\n              <option value=\"all\">Все</option>\n              <option value=\"высокий\">Высокий</option>\n              <option value=\"хороший\">Хороший</option>\n              <option value=\"средний\">Средний</option>\n              <option value=\"низкий\">Низкий</option>\n            </select>\n          </div>\n          <div className=\"flex flex-col\">\n            <label className=\"text-xs text-slate-500 dark:text-slate-400 mb-1\">С даты</label>\n            <input\n              type=\"date\"\n              value={filters.from ? filters.from.slice(0, 10) : \"\"}\n              onChange={handleFromChange}\n              className=\"w-36 rounded-md border border-slate-200 px-2 py-1 text-sm shadow-sm focus:border-primary-500 focus:outline-none focus:ring-1 focus:ring-primary-500 dark:bg-slate-900 dark:border-slate-700 dark:text-slate-100\"\n            />\n          </div>\n          <div className=\"flex flex-col\">\n            <label className=\"text-xs text-slate-500 dark:text-slate-400 mb-1\">По дату</label>\n            <input\n              type=\"date\"\n              value={filters.to ? filters.to.slice(0, 10) : \"\"}\n              onChange={handleToChange}\n              className=\"w-36 rounded-md border border-slate-200 px-2 py-1 text-sm shadow-sm focus:border-primary-500 focus:outline-none focus:ring-1 focus:ring-primary-500 dark:bg-slate-900 dark:border-slate-700 dark:text-slate-100\"\n            />\n          </div>\n          <div className=\"flex flex-col\">\n            <label className=\"text-xs text-slate-500 dark:text-slate-400 mb-1\">На странице</label>\n            <select\n              value={limit}\n              onChange={handleLimitChange}\n              className=\"w-24 rounded-md border border-slate-200 px-2 py-1 text-sm shadow-sm focus:border-primary-500 focus:outline-none focus:ring-1 focus:ring-primary-500 dark:bg-slate-900 dark:border-slate-700 dark:text-slate-100\"\n            >\n              <option value={10}>10</option>\n              <option value={25}>25</option>\n              <option value={50}>50</option>\n            </select>\n          </div>\n        </div>\n      </div>\n\n      {showEmptyState ? (\n        <div className=\"flex flex-col items-center justify-center rounded-xl border border-dashed border-slate-200 bg-slate-50 px-6 py-10 text-center dark:border-slate-700 dark:bg-slate-900/40\">\n          <svg\n            className=\"h-12 w-12 text-slate-400\"\n            viewBox=\"0 0 48 48\"\n            fill=\"none\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n          >\n            <path\n              d=\"M10 12h28M10 20h28M10 28h16\"\n              stroke=\"currentColor\"\n              strokeWidth=\"3\"\n              strokeLinecap=\"round\"\n            />\n            <circle cx=\"36\" cy=\"32\" r=\"6\" stroke=\"currentColor\" strokeWidth=\"3\" />\n          </svg>\n          <h3 className=\"mt-4 text-sm font-semibold text-slate-700 dark:text-slate-200\">\n            Ничего не найдено\n          </h3>\n          <p className=\"mt-1 text-xs text-slate-500 dark:text-slate-400\">\n            Попробуйте изменить запрос или снять фильтры.\n          </p>\n        </div>\n      ) : (\n        <div className=\"overflow-x-auto\">\n          <table className=\"min-w-full text-sm\">\n            <thead className=\"table-header sticky top-0 z-10\">\n              <tr>\n                <th\n                  className=\"px-3 py-2 text-left cursor-pointer\"\n                  onClick={() => changeSort(\"name\")}\n                  title=\"Сортировать по имени\"\n                >\n                  Имя\n                </th>\n                <th\n                  className=\"px-3 py-2 text-left cursor-pointer\"\n                  onClick={() => changeSort(\"selected_car\")}\n                  title=\"Сортировать по модели\"\n                >\n                  Модель\n                </th>\n                <th\n                  className=\"px-3 py-2 text-left cursor-pointer\"\n                  onClick={() => changeSort(\"client_quality\")}\n                  title=\"Сортировать по качеству\"\n                >\n                  Качество\n                </th>\n                <th\n                  className=\"px-3 py-2 text-left cursor-pointer\"\n                  onClick={() => changeSort(\"datetime\")}\n                  title=\"Сортировать по дате\"\n                >\n                  Дата{dateSortArrow}\n                </th>\n                <th className=\"px-3 py-2 text-left\">Город</th>\n                <th className=\"px-3 py-2 text-left\">Источник</th>\n                <th className=\"px-3 py-2 text-left\">Канал</th>\n                <th className=\"px-3 py-2 text-right\">Действия</th>\n              </tr>\n            </thead>\n            <tbody>\n              {loading ? (\n                Array.from({ length: 6 }).map((_, idx) => (\n                  <tr key={`skeleton-${idx}`} className=\"table-row\">\n                    <td colSpan={8} className=\"px-3 py-3\">\n                      <div className=\"h-3 w-full animate-pulse rounded bg-slate-200 dark:bg-slate-700\" />\n                    </td>\n                  </tr>\n                ))\n              ) : (\n                pagedLeads.map((lead) => {\n                  const qualityClass =\n                    QUALITY_LABEL_CLASS[lead.client_quality_bucket] ||\n                    \"badge bg-slate-100 text-slate-700\";\n                  const qualityStripeClass =\n                    lead.client_quality_bucket === \"высокий\"\n                      ? \"border-l-4 border-emerald-500\"\n                      : lead.client_quality_bucket === \"хороший\"\n                      ? \"border-l-4 border-sky-500\"\n                      : lead.client_quality_bucket === \"средний\"\n                      ? \"border-l-4 border-amber-500\"\n                      : \"border-l-4 border-rose-500\";\n                  return (\n                    <tr key={lead.id} className={`table-row ${qualityStripeClass}`}>\n                      <td className=\"px-3 py-2 whitespace-nowrap text-sm text-slate-800 dark:text-slate-100\">\n                        {lead.name}\n                      </td>\n                      <td className=\"px-3 py-2 whitespace-nowrap text-sm text-slate-700 dark:text-slate-300\">\n                        {lead.selected_car}\n                      </td>\n                      <td className=\"px-3 py-2 whitespace-nowrap\">\n                        <span className={qualityClass}>\n                          {lead.client_quality_bucket} ({lead.client_quality})\n                        </span>\n                      </td>\n                      <td className=\"px-3 py-2 whitespace-nowrap text-sm text-slate-700 dark:text-slate-300\">\n                        {formatDate(lead.datetime)}\n                      </td>\n                      <td className=\"px-3 py-2 whitespace-nowrap text-sm text-slate-700 dark:text-slate-300\">\n                        {lead.city}\n                      </td>\n                      <td className=\"px-3 py-2 whitespace-nowrap text-sm text-slate-700 dark:text-slate-300\">\n                        {lead.traffic_source}\n                      </td>\n                      <td className=\"px-3 py-2 whitespace-nowrap text-sm text-slate-700 dark:text-slate-300\">\n                        {lead.messenger}\n                      </td>\n                      <td className=\"px-3 py-2 text-right\">\n                        <button\n                          onClick={() => onViewLead(lead)}\n                          className=\"inline-flex items-center rounded-md border border-slate-200 px-3 py-1 text-xs font-medium text-slate-700 hover:bg-slate-50 dark:border-slate-700 dark:text-slate-100 dark:hover:bg-slate-800\"\n                        >\n                          Просмотр\n                        </button>\n                      </td>\n                    </tr>\n                  );\n                })\n              )}\n            </tbody>\n          </table>\n        </div>\n      )}\n\n      <div className=\"mt-4 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between\">\n        <p className=\"text-xs text-slate-500 dark:text-slate-400\">\n          Показано {rowsLabel} из {filteredTotal} лидов.\n        </p>\n        <div className=\"flex items-center gap-2 justify-end\">\n          <button\n            onClick={() => goToPage(currentPage - 1)}\n            disabled={currentPage <= 1}\n            className=\"rounded-md border border-slate-200 px-2 py-1 text-xs text-slate-600 disabled:opacity-40 disabled:cursor-not-allowed hover:bg-slate-50 dark:border-slate-700 dark:text-slate-300 dark:hover:bg-slate-800\"\n          >\n            Назад\n          </button>\n          <span className=\"text-xs text-slate-600 dark:text-slate-300\">\n            Стр. {currentPage} / {totalPages}\n          </span>\n          <button\n            onClick={() => goToPage(currentPage + 1)}\n            disabled={currentPage >= totalPages}\n            className=\"rounded-md border border-slate-200 px-2 py-1 text-xs text-slate-600 disabled:opacity-40 disabled:cursor-not-allowed hover:bg-slate-50 dark:border-slate-700 dark:text-slate-300 dark:hover:bg-slate-800\"\n          >\n            Далее\n          </button>\n          <button\n            type=\"button\"\n            onClick={openExportModal}\n            className=\"ml-2 rounded-md border border-slate-200 px-3 py-1 text-xs font-medium text-slate-700 hover:bg-slate-50 dark:border-slate-700 dark:text-slate-100 dark:hover:bg-slate-800\"\n          >\n            Экспорт CSV\n          </button>\n        </div>\n      </div>\n\n      {isExportModalOpen && (\n        <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/50 p-4\">\n          <div className=\"w-full max-w-md rounded-xl border border-slate-200 bg-white p-4 shadow-lg dark:border-slate-700 dark:bg-slate-800\">\n            <h3 className=\"text-sm font-semibold text-slate-800 dark:text-slate-100\">\n              Экспорт CSV по диапазону дат\n            </h3>\n            <p className=\"mt-1 text-xs text-slate-500 dark:text-slate-400\">\n              Выберите начальную и конечную даты. В экспорт попадут только лиды в этом диапазоне.\n            </p>\n\n            <div className=\"mt-3 grid gap-3 sm:grid-cols-2\">\n              <label className=\"text-xs text-slate-600 dark:text-slate-300\">\n                Start Date\n                <input\n                  type=\"date\"\n                  value={exportFrom}\n                  onChange={(e) => setExportFrom(e.target.value)}\n                  className=\"mt-1 w-full rounded-md border border-slate-200 px-2 py-1 text-sm focus:border-primary-500 focus:outline-none focus:ring-1 focus:ring-primary-500 dark:bg-slate-900 dark:border-slate-700 dark:text-slate-100\"\n                />\n              </label>\n              <label className=\"text-xs text-slate-600 dark:text-slate-300\">\n                End Date\n                <input\n                  type=\"date\"\n                  value={exportTo}\n                  onChange={(e) => setExportTo(e.target.value)}\n                  className=\"mt-1 w-full rounded-md border border-slate-200 px-2 py-1 text-sm focus:border-primary-500 focus:outline-none focus:ring-1 focus:ring-primary-500 dark:bg-slate-900 dark:border-slate-700 dark:text-slate-100\"\n                />\n              </label>\n            </div>\n\n            <div className=\"mt-4 flex justify-end gap-2\">\n              <button\n                type=\"button\"\n                onClick={closeExportModal}\n                disabled={exportLoading}\n                className=\"rounded-md border border-slate-200 px-3 py-1 text-xs text-slate-700 hover:bg-slate-50 disabled:opacity-60 dark:border-slate-700 dark:text-slate-200 dark:hover:bg-slate-700\"\n              >\n                Отмена\n              </button>\n              <button\n                type=\"button\"\n                onClick={exportToCsv}\n                disabled={exportLoading}\n                className=\"rounded-md bg-primary-600 px-3 py-1 text-xs font-medium text-white hover:bg-primary-700 disabled:opacity-60\"\n              >\n                {exportLoading ? \"Экспорт...\" : \"Скачать CSV\"}\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default LeadsTable;\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}